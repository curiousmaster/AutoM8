#!/usr/bin/env python3
# =====================================================================
# File: autom8
# Description: Wrapper launcher for Autom8 TUI (absolute-path aware)
# Author: Stefan Benediktsson (c) 2025
# =====================================================================

import os
import sys

# ---------------------------------------------------------------------
# Locate the real package directory even if run via symlink or elsewhere
# ---------------------------------------------------------------------
# Resolve the path of this script (follow symlinks)
SCRIPT_PATH = os.path.realpath(__file__)
SCRIPT_DIR = os.path.dirname(SCRIPT_PATH)

# autom8_pkg is expected to be a sibling directory to this script
PKG_DIR = os.path.join(SCRIPT_DIR, "autom8_pkg")

# Add both the script directory and its parent to sys.path
for path in (SCRIPT_DIR, PKG_DIR, os.path.dirname(SCRIPT_DIR)):
    if path not in sys.path:
        sys.path.insert(0, path)

# ---------------------------------------------------------------------
# Launch Autom8
# ---------------------------------------------------------------------
try:
    from autom8_pkg.__main__ import main
except ModuleNotFoundError as e:
    sys.stderr.write(f"[FATAL] Could not import autom8_pkg: {e}\n")
    sys.stderr.write(f"Checked paths:\n  SCRIPT_DIR={SCRIPT_DIR}\n  PKG_DIR={PKG_DIR}\n  sys.path={sys.path}\n")
    sys.exit(1)

if __name__ == "__main__":
    sys.exit(main())

